<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="./template.xhtml">
    <ui:define name="body">
        <p:panel header="#{gestorContrato.modoModificar?'Modificar':'Nuevo'} Contrato">
            <h:panelGrid columns="3">
                <p:outputLabel value="Código Contrato"/>
                <p:inputText id="txtCodigo" requiredMessage="Requerido" required="true" value="#{gestorContrato.contrato.codigoContrato}"/>  
                <p:message for="txtCodigo"/>

                <p:outputLabel value="Cargo"/>
                <p:inputText id="txtCargo" requiredMessage="Requerido" required="true" value="#{gestorContrato.contrato.cargo}"/>  
                <p:message for="txtCargo"/>

                <p:outputLabel value="Actividad Principal"/>
                <p:inputText id="txtActividad" requiredMessage="Requerido" required="true" value="#{gestorContrato.contrato.actividadPrincipal}"/>  
                <p:message for="txtActividad"/>


                <p:outputLabel value="Persona"/>
                <p:selectOneMenu style="width: 150px" id="cmbPersona2" value="#{gestorContrato.contrato.persona}" converter="personaConverter"
                                 var="uni" filter="true" filterMatchMode="contains">
                    <f:selectItems value="#{gestorPersona.listaPersonas}" var="u2" itemLabel="#{u2.nombres} #{u2.apellidos}" itemValue="#{u2}" />

                    <p:column style="width:10%">
                        <p:outputLabel value="#{uni.nombres} #{uni.apellidos}"/>
                    </p:column>
                </p:selectOneMenu>
                <h:panelGroup layout="block"/>

                <p:outputLabel value="Administrador" />
                <p:selectOneMenu style="width: 150px" id="cmbPersona" value="#{gestorContrato.contrato.administrador}" converter="personaConverter"
                                 var="per" filter="true" filterMatchMode="contains">
                    <f:selectItems value="#{gestorPersona.listaPersonasConContrato}" var="u" itemLabel="#{u.nombres} #{u.apellidos}" itemValue="#{u}" />

                    <p:column style="width:10%">
                        <p:outputLabel value="#{per.nombres} #{per.apellidos}"/>
                    </p:column>
                </p:selectOneMenu>                                
                <h:panelGroup layout="block"/>

                <p:outputLabel value="Proyecto" />
                <p:selectOneMenu id="cmbProyecto" style="width: 150px" value="#{gestorContrato.contrato.proyecto}" converter="proyectoConverter"
                                 var="per2" filter="true" filterMatchMode="contains">
                    <f:selectItem itemLabel="Ninguno" itemValue="" />
                    <f:selectItems value="#{gestorProyecto.listaProyecto}" var="u2" itemLabel="#{u2.titulo}" itemValue="#{u2}" />

                    <p:column style="width:10%">
                        <p:outputLabel value="#{per2.titulo}"/>
                    </p:column>
                </p:selectOneMenu>                                
                <h:panelGroup layout="block"/>


                <p:outputLabel value="Tipo de Contrato"/>
                <p:selectOneMenu value="#{gestorContrato.contrato.tipo}" style="width: 150px">
                    <f:selectItems value="#{gestorContrato.tiposContrato}" var="tipo"
                                   itemValue="#{tipo}" itemLabel="#{label['contrato.tipo.' += tipo]}" />
                    <p:ajax event="change" partialSubmit="true" process="@this" update="divChkEsProfesor" />
                </p:selectOneMenu>
                <h:panelGroup layout="block"/> 

                <h:panelGroup layout="block" id="divChkEsProfesor">
                    <p:selectBooleanCheckbox rendered="#{gestorContrato.puedeSerContratoProfesor()}" value="#{gestorContrato.esProfesor}" itemLabel="Es profesor">
                        <p:ajax update="divCmbTipoProfesor"/>
                    </p:selectBooleanCheckbox>
                </h:panelGroup>
                <h:panelGroup layout="block" id="divCmbTipoProfesor">
                    <p:selectOneMenu rendered="#{gestorContrato.puedeSerContratoProfesor() and gestorContrato.esProfesor}" value="#{gestorContrato.contrato.tipoProfesor}" style="width: 150px">
                        <f:selectItems value="#{gestorContrato.tiposProfesor}" var="tipo"
                                       itemValue="#{tipo}" itemLabel="#{label['contrato.tipoProfesor.' += tipo]}" />
                    </p:selectOneMenu>
                </h:panelGroup>
                <h:panelGroup/>



                <p:outputLabel value="Fecha de inicio"/>
                <p:calendar pattern="dd/MM/yyyy" value="#{gestorContrato.contrato.fechaInicio}"/>  
                <h:panelGroup layout="block"/>

                <p:outputLabel value="Fecha de finalización"/>
                <p:calendar pattern="dd/MM/yyyy" value="#{gestorContrato.contrato.fechaFin}"/>  
                <h:panelGroup layout="block"/>
                
                <p:outputLabel value="Contrato PDF"/>
                <h:panelGroup layout="block">
                    <p:fileUpload fileUploadListener="#{gestorContrato.fileUploadListener}" 
                                  mode="advanced"
                                  update="spanTamanioArchivo" 
                                  auto="true" 
                                  sizeLimit="15728640" 
                                  allowTypes="/(\.|\/)(pdf|docx?)$/" 
                                  accept="*.pdf|*.doc|*.docx"
                                  invalidFileMessage="Archivo no válido. Solo se permite PDF y DOC." 
                                  fileLimitMessage="Máximo 15MB" label="Elegir..."
                                  /> 
                    <br/>
                    <h:panelGroup id="spanTamanioArchivo">
                        <p:outputLabel id="lblTamanioArchivo" rendered="#{gestorContrato.contrato.archivoContrato != ''}" value="Tamaño archivo: #{gestorContrato.tamanoArchivo}"/>
                    </h:panelGroup>
                </h:panelGroup> 
                <h:panelGroup layout="block"/> 

            </h:panelGrid>        
        </p:panel>
        <h:panelGroup layout="block" style="height: 15px"/>
        <p:commandButton value="Guardar" update="formContenido" action="#{gestorContrato.guardar()}" icon="fa fa-save"/>
    </ui:define>
</ui:composition>